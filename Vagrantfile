Vagrant.configure("2") do |config|
    config.vm.define "CVE", autostart: true do |cfg|
        cfg.vm.box = "ubuntu/jammy64"
        cfg.vm.hostname = "CVE"
        cfg.vm.network :private_network, ip: "192.168.57.98", gateway: "192.168.57.1", dns: "8.8.8.8"
        cfg.vm.network "public_network"
        cfg.vm.boot_timeout = 1200
        cfg.vm.provider "virtualbox" do |vb|
            vb.gui = true
            vb.name = "CVE"
            vb.cpus = 2
            vb.memory = "8192"
        end

        cfg.vm.provision "shell", run: "once", inline: <<-SHELL
        export DEBIAN_FRONTEND=noninteractive
            rm -rf /var/lib/apt/lists/*
            apt update
            apt -y upgrade
            apt -y install docker.io docker-compose dos2unix
            apt -y autoremove
            apt clean
            cd /vagrant
            dos2unix data/vulnerability-tables-cron/build/entrypoint.sh
            dos2unix data/vulnerability-tables-cron/scripts/download.sh
            docker-compose up -d
            sleep 10
            docker exec -t vulnerability-tables-cron bash /opt/scripts/download.sh
        SHELL
    end
end
